# プロジェクト開発状況

**最終更新**: 2025-06-21  
**現在のフェーズ**: フェーズ2.3完了 - 戦略的購買システム確立

## 現在の開発状況

### ✅ 完了済みフェーズ
- **フェーズ0-4**: 基本ゲームループ実装済み
  - Flask Webアプリケーション基盤
  - 買うモード・売るモードの基本機能
  - AIオークションシステム
  - 商品管理・在庫システム
  - ゲーム状態管理

- **リファクタリング**: ゲームロジックとUI分離完了
  - core/api/web層の3層アーキテクチャ実装
  - JSON API設計で将来のUI変更に対応

- **フェーズ1完了**: 長期成長保証システム完成
  - ✅ 大ターン・子ターンシステム (8子ターン/大ターン)
  - ✅ 価格倍率曲線生成 (基礎システム)
  - ✅ ターン進行機能とデバッグページ

- **フェーズ2.3完了**: 戦略的購買システム確立
  - ✅ UFOサイズパラメータ廃止 (年数×距離のシンプル計算)
  - ✅ 可変目標倍率システム (1.0～10.0倍)
  - ✅ 固定費システム導入 (資産×5%)
  - ✅ 価格倍率曲線の正確な実現 (誤差±0.05)
  - ✅ 戦略的投資判断システム完成

### 📋 次のステップ
1. **フェーズ2.4以降**: より高度な戦略要素
   - 市場予測ヒントシステム
   - 複数商品カテゴリの相関性
   - リスクリターンの多様化
2. **フェーズ5**: LLM連携による演出強化
3. **UI改善**: より直感的なインターフェース

## 技術的現状

### アーキテクチャ
```
timetravel/
├── core/           # ゲームロジック層
├── api/            # JSON API層  
├── web/            # Flask UI層
└── templates/      # HTMLテンプレート
```

### 主要システム
- **大ターン・子ターンシステム**: 8子ターン単位で価格曲線生成
- **価格倍率曲線**: 可変目標倍率(1～10倍)による戦略的成長
- **AIオークション**: 15人の動的バイヤー生成システム
- **商品システム**: ジャンル・状態・レア度による価値計算

## 次フェーズへの課題

### フェーズ2設計課題
1. **攻略性の導入**: プレイヤーの選択が結果に影響する仕組み
2. **予測要素**: 価格曲線のヒントやパターン認識
3. **リスクリターン**: 高リスク高リターンの選択肢

### 緊急度: 中
- フェーズ2設計: プレイヤーの戦略的選択要素の導入
- UI/UX改善: デバッグページの本格UI化

### 緊急度: 低
- パフォーマンス最適化
- データ永続化（現在はメモリ上のみ）

## 開発環境

### 対応環境
- **WSL/Linux**: `venv`仮想環境
- **Windows**: `venv_win`仮想環境  
- **実行**: `run.bat`でFlaskサーバー起動

### 重要ファイル
- `core/turn_system.py`: ターンシステム管理
- `core/item_system.py`: 商品・価格計算
- `templates/sell.html`: 売却UI（バグ修正対象）
- `/debug`: デバッグページ（資産推移グラフ等）

## ゲーム仕様概要

### 基本ループ
1. **購買**: タイムトラベルで商品取得（子ターン進行）
2. **売却**: AIオークションで売却益獲得
3. **成長**: 価格倍率曲線により1～10倍の可変成長

### 現在のバランス
- 初期資金: 1000円
- 大ターン終了時: 投資1→価値1～10倍の可変成長
- 子ターン数: 8ターン/大ターン
- 固定費: 資産×5%（UFO代金）

---

**フェーズ1成果**: 長期成長保証システム完成、安定したゲーヤサイクル確立  
**次回開始時の作業**: フェーズ2設計（攻略性導入）開始